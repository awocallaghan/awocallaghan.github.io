"use strict";function initFilters(a){var b=a.find("h2");b.append('<a class="filter-toggler collapsed" data-toggle="collapse" href="#projects-filters"><i class="fa fa-filter" aria-hidden="true"></i>Filter</a>'),b.after('<div id="projects-filters" class="collapse"><form class="row"><div class="col-xs-12 col-sm-6"><div class="form-group"><label for="search">Search</label><input type="text" class="form-control" name="search" placeholder="Some text..." /></div><div class="form-group"><label for="tags">Tags</label><select class="form-control" multiple name="tags"><option selected value>All</option><option value="JavaScript">JavaScript</option><option value="PHP">PHP</option><option value="Java">Java</option></select></div></div><div class="col-xs-12 col-sm-6"><button class="btn btn-primary" role="submit">Update</button><a class="btn btn-secondary" onclick="resetFilters()" href="#projects-filters">Reset</a></div></form></div>'),$("#projects-filters form").on("submit",filtersUpdated)}function initProjects(a,b){a.find(PROJECT_SELECTOR).each(function(a){$(this).data(PROJECT_DATA,b[a])})}function filtersUpdated(a){a&&a.preventDefault();var b=$(this).serializeArray().reduce(function(a,b){return b.value&&b.value.length>0&&(a.hasOwnProperty(b.name)?a[b.name].constructor===Array?a[b.name].push(b.value):a[b.name]=[a[b.name],b.value]:a[b.name]=b.value),a},{}),c=Object.keys(b).filter(function(a){return"search"!==a}),d=$(PROJECTS_SELECTOR+" "+PROJECT_SELECTOR);d.hide(),d.each(function(a){var d=$(this),e=d.data(PROJECT_DATA);if(!e)throw new Error("No project data for index "+a);var f=!0;if(b.hasOwnProperty("search")){b.search=b.search.toLowerCase();var g=e.name.toLowerCase(),h=e.description.toLowerCase();f=g.indexOf(b.search)>=0||h.indexOf(b.search)>=0}for(var i=0;f&&i<c.length;){var j=c[i],k=b[j];if(k.constructor===Array)if(e[j].constructor===Array){for(var l=!1,m=0;!l&&m<e[j].length;){for(var n=0;!l&&n<k.length;)l=e[j][m]===k[n],n++;m++}f=l}else{for(var o=!1,p=0;!o&&p<k.length;)o=e[j]===k[p],p++;f=o}else if(e[j].constructor===Array){for(var q=!1,r=0;!q&&r<e[j].length;)q=e[j][r]===k,r++;f=q}else f=e[j]===k;DEBUG&&!f?console.log(e[j],"not matches filter:",k):DEBUG&&console.log(e[j],"matches filter:",k),i++}f&&d.show()})}function resetFilters(){$("#projects-filters form")[0].reset(),filtersUpdated()}var PROJECTS_SELECTOR="#projects",PROJECT_SELECTOR=".post-preview",PROJECTS_DATA="projects",PROJECT_DATA="project",DEBUG=!1;$(function(){var a=$(PROJECTS_SELECTOR);$.get("/api/projects.json",function(b){DEBUG&&console.log("Successfully loaded projects data",b),a.data(PROJECTS_DATA,b),initFilters(a),initProjects(a,b.projects)}).fail(function(a){console.error("Error loading project data",a),console.log(a.responseText)})});